@model TouristAgency.Models.Destination
@{
    ViewData["Title"] = "Дестинация: " + Model.Name;
}

<h2>@Model.Name</h2>
<p><strong>Описание:</strong> @Model.Description</p>
<p><strong>Сезон:</strong> @Model.Season</p>

<div id="map" style="height: 400px;" class="mb-4"></div>

<h4>Налични туристически пакети:</h4>
@if (Model.TravelPackages != null && Model.TravelPackages.Any())
{
    <ul class="list-group">
        @foreach (var pkg in Model.TravelPackages)
        {
            <li class="list-group-item">
                <a asp-controller="TravelPackages" asp-action="Details" asp-route-id="@pkg.Id">@pkg.Title</a>
                - @string.Format("{0:C}", pkg.Price)
            </li>
        }
    </ul>
}
else
{
    <p class="text-muted">В момента няма налични пакети за тази дестинация.</p>
}

@section Scripts {
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

    <script>
        var lat = @Model.Latitude.ToString(System.Globalization.CultureInfo.InvariantCulture);
        var lng = @Model.Longitude.ToString(System.Globalization.CultureInfo.InvariantCulture);
        var map = L.map('map').setView([lat, lng], 8);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
            attribution: '© OpenStreetMap contributors'
        }).addTo(map);

        L.marker([lat, lng]).addTo(map)
            .bindPopup('@Model.Name')
            .openPopup();
    </script>
}
